webpackJsonp([3],{CPEB:function(e,t){},FrBS:function(e,t){},QOvy:function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/PjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+PHN2ZyB0PSIxNTIyNjQ5Nzk1MjU1IiBjbGFzcz0iaWNvbiIgc3R5bGU9IiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjUxOTYiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMzIiIGhlaWdodD0iMzIiPjxkZWZzPjxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+PC9zdHlsZT48L2RlZnM+PHBhdGggZD0iTTQ0OCA1NzYgNTc2IDU3NiA1NzYgMzIwIDc2OCAzMjAgNTEyIDY0IDI1NiAzMjAgNDQ4IDMyMHpNNjQwIDQzMiA2NDAgNTMwLjcyIDkzMy4wNTYgNjQwIDUxMiA3OTcuMDI0IDkwLjk0NCA2NDAgMzg0IDUzMC43MiAzODQgNDMyIDAgNTc2IDAgODMyIDUxMiAxMDI0IDEwMjQgODMyIDEwMjQgNTc2eiIgcC1pZD0iNTE5NyIgZmlsbD0iI0ZGNjg1RCI+PC9wYXRoPjwvc3ZnPg=="},xiKa:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i("Dd8w"),l=i.n(s),n={APPLY_QINIUUPLOADTOKEN_API:"http://api.agentily.com/qiniu/",QINIU_UPLOAD_HTTP_API:"http://up-z0.qiniu.com",QINIU_UPLOAD_HTTPS_API:"https://up.qbox.me"},a=i("P9l9"),o=i("NYxO"),r={props:["imgtype"],data:function(){return{error:null,buttonAvailable:!0,autoUpload:!0,file:{self:null,size:null,type:null,suffix:null},serverToken:{token:null,expire:null,key:null,url:null},successImages:[]}},computed:{},activated:function(){this.$store.state.roomimg=null},methods:l()({},Object(o.c)(["addroomimg","deleteroomimg","adduserimg","deleteuserimg"]),{uploadButtonOnClick:function(){this.buttonAvailable=!1;this.applyUploadToken(this.file.suffix,function(e){this.serverToken=e,this.uploadFileToQiniu()}.bind(this),function(e){this.buttonAvailable=!0,this.error=e}.bind(this))},fileInputOnChange:function(e){var t=e.currentTarget.files[0];null!=t?(this.showPreview=!0,this.file={self:t,size:t.size,type:t.type,suffix:t.name.substring(t.name.lastIndexOf(".")+1,t.name.length).toLowerCase()},this.previewImage(t),this.autoUpload&&this.uploadButtonOnClick()):this.reset()},reset:function(){this.file={self:null,size:null,type:null,suffix:null},this.error=null,this.buttonAvailable=!0},previewImage:function(e){if(window.FileReader){var t=new FileReader;t.onloadend=function(e){document.querySelector(".preview #image").src=e.target.result},t.readAsDataURL(e)}else console.warn("不支持 FileReader")},applyUploadToken:function(e,t,i){var s={suffix:e};this.$http.post(n.APPLY_QINIUUPLOADTOKEN_API,s).then(function(e){200===e.status?(t(e.data),console.log(e.data)):i("向服务器请求上传 token 失败")},function(){i("检查您的网络连接")})},uploadFileToQiniu:function(){var e=this;if(null!=this.file.self){console.log("开始上传文件");var t=new FormData;t.append("token",this.serverToken.token),t.append("file",this.file.self),t.append("key",this.serverToken.key),this.axios({method:"post",url:n.QINIU_UPLOAD_HTTP_API,headers:{"Content-Type":"multipart/form-data"},data:t}).then(function(t){if(200===t.status){e.successImages.push(e.serverToken.url);var i=e.serverToken.url;"profile"===e.imgtype?e.adduserimg(i):e.addroomimg(i),e.reset()}},function(){e.error="上传文件到七牛异常"})}else this.error="上传文件到七牛异常"},DeleteFileFromQiniu:function(e){var t=this;Object(a.c)({image:e}).then(function(i){console.log(i),t.successImages.pop(e),"profile"===t.imgtype?t.deleteuserimg(e):t.deleteroomimg(e)}).catch(function(e){console.log(e)})}})},u={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"uploader"},[null!=e.successImages&&e.successImages.length>0?s("div",{staticClass:"success-images"},[s("p",[e._v("上传列表"+e._s(e.imgtype)+"+"+e._s(e.successImages))]),e._v(" "),s("div",{staticClass:"uploaded-wrapper"},e._l(e.successImages,function(t,i){return s("div",{key:i,staticClass:"upload-item"},[s("yd-icon",{staticClass:"deleteIcon",attrs:{name:"error-outline"},nativeOn:{click:function(i){e.DeleteFileFromQiniu(t)}}}),e._v(" "),s("img",{staticClass:"uploadedImg",attrs:{src:"http://"+t,num:e.successImages.length}})],1)}))]):e._e(),e._v(" "),null!=e.error?s("p",{staticClass:"error-color"},[e._v("错误信息："+e._s(e.error))]):e._e(),e._v(" "),null!=e.file.size?s("div",{staticClass:"preview"},[s("img",{attrs:{id:"image"}}),e._v(" "),s("h3",[e._v("文件大小："+e._s(e.file.size/1024)+" KB")]),e._v(" "),s("h3",[e._v("文件类型："+e._s(e.file.type))])]):e._e(),e._v(" "),s("div",{staticClass:"upload-btn"},[s("input",{staticClass:"upload-img",attrs:{title:"",type:"file",accept:"image/*",name:"file"},on:{change:function(t){e.fileInputOnChange(t)}}}),e._v(" "),s("img",{attrs:{src:i("QOvy"),alt:""}}),e._v(" "),s("p",[e._v("Upload")])]),e._v(" "),e.autoUpload?e._e():s("button",{attrs:{disabled:null!=e.file.size&&e.buttonAvailable?null:"disabled"},on:{click:function(t){e.uploadButtonOnClick()}}},[e._v("Upload")])])},staticRenderFns:[]};var c=i("VU/8")(r,u,!1,function(e){i("CPEB")},"data-v-7efd3874",null).exports,d=i("u4WU"),p=i("r8FW"),g={components:{Vqiniu:c,CellGroup:p.CellGroup,CellItem:p.CellItem,Input:p.Input},data:function(){return{userInfo:{username:"",profile:[]}}},computed:l()({},Object(o.d)(["userimg"])),methods:{getUserinfo:function(){var e=this;this.userInfo.username=d.a.getCookie("username"),Object(a.j)(this.userInfo.username).then(function(t){e.userInfo=t.data})},updateUserInfo:function(){var e=this;console.log(this.userimg),this.userInfo.profile=this.userimg.join(","),Object(a.h)(this.userInfo).then(function(t){e.res}).catch()}},created:function(){this.getUserinfo()},activated:function(){this.userimg=null}},f={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"profile-wrapper"},[i("yd-navbar",{attrs:{title:"Your profile"}},[i("router-link",{attrs:{slot:"left",to:"/setting"},slot:"left"},[i("yd-navbar-back-icon",[e._v("back")])],1)],1),e._v(" "),i("h1",{staticClass:"bigtitle"}),e._v(" "),i("yd-cell-group",{attrs:{title:"Picture"}},[i("Vqiniu",{attrs:{imgtype:"profile"}})],1),e._v(" "),i("yd-cell-group",{attrs:{title:"Name"}},[i("yd-cell-item",[i("span",{attrs:{slot:"left"},slot:"left"}),e._v(" "),i("yd-input",{attrs:{slot:"right",type:"text",required:"",max:"20",placeholder:" Your name"},slot:"right",model:{value:e.userInfo.username,callback:function(t){e.$set(e.userInfo,"username",t)},expression:"userInfo.username"}})],1)],1),e._v(" "),i("yd-cell-group",{attrs:{title:"About me"}},[i("yd-cell-item",[i("yd-textarea",{attrs:{slot:"right",placeholder:"tell a little about yourself",maxlength:"200"},slot:"right"})],1)],1),e._v(" "),i("yd-cell-group",{attrs:{title:"What do you do?"}},[i("yd-cell-item",[i("yd-input",{attrs:{slot:"right",type:"text",required:"",max:"20",placeholder:" "},slot:"right"})],1)],1),e._v(" "),i("yd-cell-group",{attrs:{title:"Gender"}},[i("yd-cell-item",{attrs:{arrow:""}},[i("select",{attrs:{slot:"right"},slot:"right"},[i("option",{attrs:{value:"1"}},[e._v("male")]),e._v(" "),i("option",{attrs:{value:"2"}},[e._v("female")]),e._v(" "),i("option",{attrs:{value:"3"}},[e._v("others")])])])],1),e._v(" "),i("yd-cell-group",{attrs:{title:"My ideal living location"}},[i("yd-cell-item",{attrs:{arrow:""}},[i("select",{attrs:{slot:"right"},slot:"right"},[i("option",{attrs:{value:"1"}},[e._v("guy")]),e._v(" "),i("option",{attrs:{value:"2"}},[e._v("girl")]),e._v(" "),i("option",{attrs:{value:"3"}},[e._v("other")])])])],1),e._v(" "),i("yd-button-group",[i("yd-button",{attrs:{size:"large",type:"primary"},nativeOn:{click:function(t){return e.updateUserInfo(t)}}},[e._v("Save")])],1)],1)},staticRenderFns:[]};var v=i("VU/8")(g,f,!1,function(e){i("FrBS")},"data-v-b0556ed2",null);t.default=v.exports}});
//# sourceMappingURL=3.a66f73035c415e654cd6.js.map